name: HTML Help HH.EXE Suspicious Child Process
id: 52cad028-0ff0-4854-8f67-d25dfcbc78b4
author: Maxim Pavlunin, Nasreddine Bencherchali (Nextron Systems)
date: 2020/04/01
level: high
description: Detects a suspicious child process of a Microsoft HTML Help (HH.exe)
status: test
modified: 2023/04/12
logsource:
  category: process_creation
  product: windows
tactics:
- defense_evasion
- execution
- initial_access
relevantTechniques:
- t1047
- t1059.001
- t1059.003
- t1059.005
- t1059.007
- t1218
- t1218.001
- t1218.010
- t1218.011
- t1566
- t1566.001
query: 'DeviceProcessEvents

  | where (FolderPath endswith "\\CertReq.exe" or FolderPath endswith "\\CertUtil.exe"
  or FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\cscript.exe" or FolderPath
  endswith "\\installutil.exe" or FolderPath endswith "\\MSbuild.exe" or FolderPath
  endswith "\\MSHTA.EXE" or FolderPath endswith "\\msiexec.exe" or FolderPath endswith
  "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\regsvr32.exe"
  or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\schtasks.exe"
  or FolderPath endswith "\\wmic.exe" or FolderPath endswith "\\wscript.exe") and
  InitiatingProcessFolderPath endswith "\\hh.exe"'
