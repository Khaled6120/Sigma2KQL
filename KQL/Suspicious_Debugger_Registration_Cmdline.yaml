name: Suspicious Debugger Registration Cmdline
id: ae215552-081e-44c7-805f-be16f975c8a2
author: Florian Roth (Nextron Systems), oscd.community, Jonhnathan Ribeiro
date: 2019/09/06
level: high
description: Detects the registration of a debugger for a program that is available
  in the logon screen (sticky key backdoor).
status: test
modified: 2022/08/06
logsource:
  category: process_creation
  product: windows
tactics:
- persistence
- privilege_escalation
relevantTechniques:
- t1546.008
query: 'DeviceProcessEvents

  | where ProcessCommandLine contains "\\CurrentVersion\\Image File Execution Options\\"
  and (ProcessCommandLine contains "sethc.exe" or ProcessCommandLine contains "utilman.exe"
  or ProcessCommandLine contains "osk.exe" or ProcessCommandLine contains "magnify.exe"
  or ProcessCommandLine contains "narrator.exe" or ProcessCommandLine contains "displayswitch.exe"
  or ProcessCommandLine contains "atbroker.exe" or ProcessCommandLine contains "HelpPane.exe")'
