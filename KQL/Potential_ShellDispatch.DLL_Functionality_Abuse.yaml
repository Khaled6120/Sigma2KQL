name: Potential ShellDispatch.DLL Functionality Abuse
id: 82343930-652f-43f5-ab70-2ee9fdd6d5e9
author: X__Junior (Nextron Systems)
date: 2023/06/20
level: medium
description: Detects potential "ShellDispatch.dll" functionality abuse to execute
  arbitrary binaries via "ShellExecute"
status: test
modified: ''
logsource:
  category: process_creation
  product: windows
tactics:
- defense_evasion
- execution
relevantTechniques: []
query: 'DeviceProcessEvents

  | where ProcessCommandLine contains "RunDll_ShellExecuteW" and (FolderPath endswith
  "\\rundll32.exe" or ProcessVersionInfoOriginalFileName =~ "RUNDLL32.EXE")'
