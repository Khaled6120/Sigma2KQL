name: Service Reconnaissance Via Wmic.EXE
id: 76f55eaa-d27f-4213-9d45-7b0e4b60bbae
author: frack113, Nasreddine Bencherchali (Nextron Systems)
date: 2023/02/14
level: medium
description: 'An adversary might use WMI to check if a certain remote service is running
  on a remote device.

  When the test completes, a service information will be displayed on the screen if
  it exists.

  A common feedback message is that "No instance(s) Available" if the service queried
  is not running.

  A common error message is "Node - (provided IP or default) ERROR Description =The
  RPC server is unavailable" if the provided remote host is unreachable

  '
status: test
modified: ''
logsource:
  category: process_creation
  product: windows
tactics:
- execution
relevantTechniques:
- t1047
query: 'DeviceProcessEvents

  | where ProcessCommandLine contains "service" and (FolderPath endswith "\\WMIC.exe"
  or ProcessVersionInfoOriginalFileName =~ "wmic.exe")'
